<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Animated Sticky Header with Dark Mode</title>
  <style>
    :root {
      --bg-light: #f0f0f0;
      --bg-dark: #121212;
      --text-light: #333;
      --text-dark: #f9f9f9;
      --header-bg-light: #333;
      --header-bg-dark: #222;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      transition: background 0.5s ease, color 0.5s ease;
      background: var(--bg-light);
      color: var(--text-light);
    }

    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }

    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: var(--header-bg-light);
      color: white;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: box-shadow 0.3s ease, background 0.5s ease;
      z-index: 1000;
    }

    body.dark header {
      background: var(--header-bg-dark);
    }

    header.sticky {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }

    .sentinel {
      height: 1px;
    }

    main {
      margin-top: 80px;
      padding: 2rem;
      height: 2000px;
      position: relative;
      z-index: 1;
    }

    .toggle-btn {
      background: none;
      border: 1px solid white;
      color: white;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-radius: 5px;
      transition: background 0.3s ease;
    }

    .toggle-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .animated-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      background: linear-gradient(135deg, #ff9a9e, #fad0c4, #fbc2eb);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      opacity: 0.2;
      pointer-events: none;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
  </style>
</head>
<body>

  <div class="animated-bg"></div>

  <header id="page-header">
    <h1>My Awesome Header</h1>
    <button class="toggle-btn" id="theme-toggle">Toggle Dark Mode</button>
  </header>

  <div class="sentinel"></div>

  <main>
    <p>Scroll down to see the sticky effect and enjoy the animated background!</p>
  </main>

  <script>
    const header = document.getElementById('page-header');
    const sentinel = document.querySelector('.sentinel');
    const toggleBtn = document.getElementById('theme-toggle');
    const body = document.body;

    // Sticky header logic
    const observer = new IntersectionObserver(
      ([entry]) => {
        header.classList.toggle('sticky', !entry.isIntersecting);
      },
      { threshold: 0 }
    );
    observer.observe(sentinel);

    // Dark mode logic
    const setTheme = (isDark) => {
      body.classList.toggle('dark', isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    };

    toggleBtn.addEventListener('click', () => {
      setTheme(!body.classList.contains('dark'));
    });

    // Load saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') setTheme(true);
  </script>

</body>
</html>